
###############################################################################
# Bootstrap marker checks (Bastion)
####################################################################
- name: Check if bootstrap TLS marker exists on Bastion
  stat:
    path: "{{ bootstrap_tls_dir }}/BOOTSTRAP_COMPLETE"
  register: bootstrap_marker
  changed_when: false


- name: Fail if bootstrap TLS has already been applied
  fail:
    msg: >
      Bootstrap TLS marker found on Bastion.
      This playbook is intentionally one-time and must not be rerun.
  when: bootstrap_marker.stat.exists